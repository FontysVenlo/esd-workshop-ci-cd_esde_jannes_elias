name: CI (Build & Test)

on:
  push:
    branches: "**"
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:

concurrency:
  group: ci-${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

permissions:
  contents: read

jobs:
  build:
    name: CI Skeleton
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17

      - name: Setup Gradle (cache)
        uses: gradle/actions/setup-gradle@v4

      # ------------------------- STUDENT TODOs -------------------------
      # TODO: Replace this placeholder with a build step that:
      #  - cleans previous outputs,
      #  - compiles and runs unit tests,
      #  - generates a machine-readable coverage report for the test run,
      #  - and produces a runnable application artifact.
      # Expectation:
      #  - The workflow fails if tests fail.
      #  - A coverage XML is produced in the standard reports location.
      #  - The application artifact is available under the usual build folder.
      - name: TODO – build, tests, coverage
        run: echo "Build, run tests, generate coverage report, and build the app artifact."

      # TODO: Add a step to upload the HTML coverage report
      # as a workflow artifact so it can be viewed from the Actions run summary.
      # Expectation:
      #  - The artifact is named clearly (e.g., coverage report).
      #  - The uploaded path corresponds to the HTML coverage output directory.
      # - name: TODO – upload HTML coverage artifact
      #   run: echo "Upload the HTML coverage directory as an artifact."

      # TODO: Add a step to publish the coverage XML to a coverage service
      # (e.g., Codecov) so PRs get a coverage status/check.
      # Expectation:
      #  - The step runs after tests/coverage have completed.
      #  - It references the generated XML report.
      #  - It uses the appropriate authentication mechanism for same-repo runs.
      # - name: TODO – upload coverage to coverage service
      #   run: echo "Upload the XML coverage report to an external service."
      # ----------------------------------------------------------------



      # TODO-3 (optional): Upload coverage to Codecov

